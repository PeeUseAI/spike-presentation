<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SPIKE Performance Journey — Thong Thai</title>
<style>
/* ===== RESET & BASE ===== */
* { margin: 0; padding: 0; box-sizing: border-box; }
html, body {
  width: 100%; height: 100%;
  overflow: hidden;           /* no scrollbars — we control everything */
  font-family: 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
  background: #0a0a0a;       /* near-black background */
  color: #ffffff;
  cursor: pointer;            /* hint that clicking advances */
  user-select: none;          /* prevent accidental text selection */
}

/* ===== SLIDE CONTAINER ===== */
.slide {
  position: absolute;
  top: 0; left: 0;
  width: 100%; height: 100%;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  padding: 60px 80px;
  opacity: 0;                 /* hidden by default */
  pointer-events: none;       /* can't interact when hidden */
  transition: opacity 0.6s ease;
}
.slide.active {
  opacity: 1;
  pointer-events: auto;
}

/* ===== SLIDE COUNTER (bottom center) ===== */
#slide-counter {
  position: fixed;
  bottom: 24px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 14px;
  color: #555;
  z-index: 100;
  letter-spacing: 2px;
}

/* ===== NAV HINT (bottom right) ===== */
#nav-hint {
  position: fixed;
  bottom: 24px;
  right: 40px;
  font-size: 12px;
  color: #444;
  z-index: 100;
}

/* ===== COLOR PALETTE ===== */
:root {
  --accent: #1a73e8;         /* SPIKE-style blue */
  --green: #34a853;
  --yellow: #fbbc04;
  --red: #ea4335;
  --bg-card: #1a1a1a;
  --bg-bar: #2a2a2a;
  --text-dim: #888;
}

/* ===== ANIMATIONS ===== */
@keyframes fadeInUp {
  from { opacity: 0; transform: translateY(40px); }
  to   { opacity: 1; transform: translateY(0); }
}
@keyframes fadeIn {
  from { opacity: 0; }
  to   { opacity: 1; }
}
@keyframes countUp {
  from { opacity: 0; transform: scale(0.5); }
  to   { opacity: 1; transform: scale(1); }
}
@keyframes growBar {
  from { width: 0%; }
}
@keyframes pulseGlow {
  0%, 100% { box-shadow: 0 0 8px rgba(26,115,232,0.3); }
  50%      { box-shadow: 0 0 20px rgba(26,115,232,0.6); }
}
@keyframes slideInLeft {
  from { opacity: 0; transform: translateX(-60px); }
  to   { opacity: 1; transform: translateX(0); }
}
@keyframes slideInRight {
  from { opacity: 0; transform: translateX(60px); }
  to   { opacity: 1; transform: translateX(0); }
}
@keyframes drawLine {
  from { width: 0; }
  to   { width: 100%; }
}
@keyframes popIn {
  from { opacity: 0; transform: scale(0); }
  to   { opacity: 1; transform: scale(1); }
}

/* Utility: animate children one-by-one */
.stagger > * {
  opacity: 0;
  animation: fadeInUp 0.5s ease forwards;
}
/* Each child gets a delay — set via inline style or JS */

/* ===== SLIDE 1: TITLE ===== */
#slide1 {
  background: radial-gradient(ellipse at center, #1a1a2e 0%, #0a0a0a 70%);
}
.three-stripes {
  display: flex;
  gap: 6px;
  margin-bottom: 40px;
  opacity: 0;
}
.three-stripes .stripe {
  width: 8px;
  height: 50px;
  background: #fff;
  border-radius: 2px;
  transform: skewX(-12deg);
}
.three-stripes .stripe:nth-child(1) { height: 30px; }
.three-stripes .stripe:nth-child(2) { height: 40px; }
.three-stripes .stripe:nth-child(3) { height: 50px; }
#slide1 h1 {
  font-size: 64px;
  font-weight: 700;
  letter-spacing: -1px;
  opacity: 0;
  text-align: center;
}
#slide1 h1 span { color: var(--accent); }
#slide1 .subtitle {
  font-size: 24px;
  color: var(--text-dim);
  margin-top: 16px;
  opacity: 0;
  text-align: center;
}
#slide1 .year-arrow {
  color: var(--accent);
  font-weight: 700;
}

/* ===== SLIDE 2 & 3: SCORECARD BAR CHARTS ===== */
.slide-header {
  width: 100%;
  text-align: center;
  margin-bottom: 32px;
}
.slide-header h2 {
  font-size: 36px;
  font-weight: 600;
  opacity: 0;
}
.slide-header .score-badge {
  display: inline-block;
  font-size: 48px;
  font-weight: 700;
  color: var(--accent);
  margin: 8px 16px 0 0;
  opacity: 0;
}
.slide-header .rank-badge {
  display: inline-block;
  font-size: 28px;
  font-weight: 600;
  color: var(--text-dim);
  opacity: 0;
}
.rank-change {
  display: inline-block;
  background: var(--green);
  color: #fff;
  border-radius: 12px;
  padding: 2px 10px;
  font-size: 16px;
  font-weight: 700;
  margin-left: 8px;
  opacity: 0;
}

.bar-chart {
  width: 100%;
  max-width: 900px;
}
/* Category label row inside bar charts */
.bar-cat-label {
  font-size: 11px;
  font-weight: 700;
  letter-spacing: 1.5px;
  text-transform: uppercase;
  padding: 2px 0 2px 0;
  margin-top: 6px;
  opacity: 0;
}
.bar-cat-label:first-child { margin-top: 0; }

.bar-row {
  display: flex;
  align-items: center;
  margin-bottom: 10px;
  opacity: 0;
}
.bar-label {
  width: 200px;
  min-width: 200px;
  text-align: right;
  padding-right: 16px;
  font-size: 14px;
  color: #ccc;
  white-space: nowrap;
}
.bar-track {
  flex: 1;
  height: 28px;
  background: var(--bg-bar);
  border-radius: 4px;
  position: relative;
  overflow: visible;
}
.bar-fill {
  height: 100%;
  border-radius: 4px;
  width: 0%;                  /* animated via JS */
  transition: width 1s ease, background-color 0.5s ease;
  position: relative;
}
.bar-value {
  position: absolute;
  right: -50px;
  top: 50%;
  transform: translateY(-50%);
  font-size: 13px;
  font-weight: 600;
  color: #ccc;
  white-space: nowrap;
}
/* Color classes for bar fills */
.bar-red    { background: linear-gradient(90deg, #c62828, #ef5350); }
.bar-yellow { background: linear-gradient(90deg, #f9a825, #fdd835); }
.bar-green  { background: linear-gradient(90deg, #2e7d32, #66bb6a); }
.bar-blue   { background: linear-gradient(90deg, #1565c0, #42a5f5); }

/* Glow effect for improved categories */
.bar-improved .bar-fill {
  box-shadow: 0 0 12px rgba(52,168,83,0.5);
}
.bar-declined .bar-fill {
  box-shadow: 0 0 12px rgba(234,67,53,0.5);
}

/* Callout badges on slide 3 */
.callouts {
  display: flex;
  gap: 20px;
  margin-top: 24px;
  flex-wrap: wrap;
  justify-content: center;
}
.callout {
  background: var(--bg-card);
  border: 1px solid #333;
  border-radius: 12px;
  padding: 12px 20px;
  text-align: center;
  opacity: 0;
}
.callout .label { font-size: 12px; color: var(--text-dim); margin-bottom: 4px; }
.callout .change { font-size: 20px; font-weight: 700; }
.callout .change.up { color: var(--green); }
.callout .change.down { color: var(--red); }

/* ===== SLIDE 4: WEIGHT OVERVIEW ===== */
.weight-chart {
  width: 100%;
  max-width: 750px;
  display: flex;
  flex-direction: column;
  gap: 24px;
}
.weight-row {
  display: flex;
  align-items: center;
  gap: 16px;
  opacity: 0;
}
.weight-label {
  width: 140px;
  min-width: 140px;
  font-size: 18px;
  font-weight: 600;
  text-align: right;
}
.weight-track {
  flex: 1;
  height: 44px;
  background: var(--bg-bar);
  border-radius: 6px;
  position: relative;
  overflow: hidden;
}
.weight-bar {
  height: 100%;
  border-radius: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: width 1.2s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
}
.weight-pct {
  font-size: 16px;
  font-weight: 700;
  color: #fff;
  white-space: nowrap;
}
.weight-change-badge {
  min-width: 70px;
  text-align: center;
  font-size: 18px;
  font-weight: 700;
  padding: 4px 12px;
  border-radius: 8px;
  opacity: 0;
}
.weight-change-badge.up {
  color: var(--green);
  background: rgba(52,168,83,0.15);
}
.weight-change-badge.down {
  color: var(--red);
  background: rgba(234,67,53,0.15);
}
.weight-change-badge.same {
  color: var(--text-dim);
  background: rgba(136,136,136,0.1);
}
.weight-note {
  margin-top: 24px;
  text-align: center;
  font-size: 16px;
  color: var(--text-dim);
  opacity: 0;
}
.weight-note strong { color: var(--accent); }

/* bar colors per category */
.weight-bar-agile       { background: linear-gradient(90deg, #0288d1, #4fc3f7); }
.weight-bar-competitive { background: linear-gradient(90deg, #f9a825, #fdd835); }
.weight-bar-esg         { background: linear-gradient(90deg, #388e3c, #81c784); }
.weight-bar-quality     { background: linear-gradient(90deg, #8e24aa, #ce93d8); }
.weight-bar-competency  { background: linear-gradient(90deg, #ef6c00, #ffb74d); }

/* ===== SLIDE 5: FRAMEWORK CHANGES ===== */
#slide5 {                       /* framework detail (was slide 4) */
  padding: 24px 50px;
  justify-content: flex-start;
  padding-top: 40px;
}

/* Column header row */
.fw-header-row {
  display: flex;
  width: 100%;
  max-width: 1100px;
  margin-bottom: 10px;
}
.fw-col-title {
  flex: 1;
  font-size: 22px;
  font-weight: 600;
  text-align: center;
  opacity: 0;
}
.fw-header-row .fw-col-arrow { width: 50px; }

/* Container for all paired rows */
.fw-rows {
  width: 100%;
  max-width: 1100px;
  display: flex;
  flex-direction: column;
  gap: 4px;
}

/* A single paired row: left | arrow | right */
.fw-row {
  display: flex;
  align-items: center;
  gap: 0;
  opacity: 0;
}
.fw-row-left, .fw-row-right {
  flex: 1;
}
.fw-row-arrow {
  width: 50px;
  text-align: center;
  font-size: 20px;
  color: var(--accent);
  flex-shrink: 0;
}

/* Category header row */
.fw-row.cat-row {
  margin-top: 6px;
}
.fw-row.cat-row:first-child { margin-top: 0; }
.fw-cat-label {
  font-size: 10px;
  font-weight: 700;
  letter-spacing: 1.5px;
  text-transform: uppercase;
  padding: 3px 0;
}
.fw-cat-agile       { color: #4fc3f7; }
.fw-cat-competitive  { color: #fdd835; }
.fw-cat-esg          { color: #81c784; }
.fw-cat-quality      { color: #ce93d8; }
.fw-cat-competency   { color: #ffb74d; }

/* KPI item card */
.fw-item {
  background: var(--bg-card);
  border: 1px solid #333;
  border-radius: 8px;
  padding: 8px 12px;
  font-size: 13px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.fw-item .pts {
  font-weight: 700;
  color: var(--accent);
  min-width: 36px;
  text-align: right;
  white-space: nowrap;
}
.fw-item-left {
  display: flex;
  flex-direction: column;
  flex: 1;
  min-width: 0;
}
.fw-desc {
  font-size: 10px;
  color: #aaa;
  margin-top: 2px;
  line-height: 1.2;
}

/* Empty placeholder when one side has no matching item */
.fw-empty {
  height: 44px;
}

.fw-item.highlight-new {
  border-color: var(--green);
  background: rgba(52,168,83,0.1);
}
.fw-item.highlight-changed {
  border-color: var(--yellow);
  background: rgba(251,188,4,0.08);
}
.fw-item.highlight-removed {
  border-color: var(--red);
  background: rgba(234,67,53,0.08);
  text-decoration: line-through;
  color: #888;
}

.fw-note {
  margin-top: 12px;
  text-align: center;
  font-size: 14px;
  color: var(--text-dim);
  opacity: 0;
}
.fw-note strong { color: var(--accent); }

/* structure badge */
.structure-badges {
  display: flex;
  gap: 16px;
  justify-content: center;
  margin-top: 10px;
}
.struct-badge {
  padding: 8px 20px;
  border-radius: 20px;
  font-size: 15px;
  font-weight: 600;
  opacity: 0;
}
.struct-foundation { background: rgba(26,115,232,0.2); border: 1px solid var(--accent); color: var(--accent); }
.struct-value { background: rgba(251,188,4,0.15); border: 1px solid var(--yellow); color: var(--yellow); }

/* ===== SLIDE 5: JAN 2026 ===== */
.bar-target-line {
  position: absolute;
  top: -2px;
  height: calc(100% + 4px);
  width: 2px;
  background: #fff;
  border-right: 2px dashed rgba(255,255,255,0.7);
  z-index: 2;
}
.bar-target-label {
  position: absolute;
  top: -16px;
  transform: translateX(-50%);
  font-size: 10px;
  color: #aaa;
  white-space: nowrap;
}
.bar-pct {
  position: absolute;
  right: -80px;
  top: 50%;
  transform: translateY(-50%);
  font-size: 12px;
  color: var(--text-dim);
  white-space: nowrap;
}
.note-badge {
  display: inline-block;
  background: rgba(234,67,53,0.15);
  color: var(--red);
  font-size: 11px;
  padding: 2px 8px;
  border-radius: 8px;
  margin-left: 8px;
}

/* ===== SLIDE 6: ROAD TO #1 ===== */
#slide7 {
  padding: 40px 80px;
}
.gauge-section {
  display: flex;
  align-items: center;
  gap: 60px;
  margin-bottom: 32px;
}
.score-circle {
  width: 200px;
  height: 200px;
  border-radius: 50%;
  border: 8px solid var(--bg-bar);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  position: relative;
  opacity: 0;
}
.score-circle .number {
  font-size: 48px;
  font-weight: 700;
}
.score-circle .label-text {
  font-size: 14px;
  color: var(--text-dim);
}
.score-circle.current { border-color: var(--accent); }
.score-circle.target  { border-color: var(--green); }
.score-arrow {
  font-size: 48px;
  color: var(--accent);
  opacity: 0;
}
.gap-info {
  text-align: center;
  opacity: 0;
}
.gap-info .points {
  font-size: 56px;
  font-weight: 700;
  color: var(--green);
}
.gap-info .label-text {
  font-size: 16px;
  color: var(--text-dim);
}
.rank-goal {
  display: flex;
  align-items: center;
  gap: 20px;
  margin-bottom: 36px;
  opacity: 0;
  justify-content: center;
}
.rank-circle {
  width: 60px; height: 60px;
  border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  font-size: 24px; font-weight: 700;
}
.rank-from { background: var(--bg-card); border: 2px solid #555; }
.rank-to   { background: rgba(52,168,83,0.2); border: 2px solid var(--green); color: var(--green); }

.gap-table {
  width: 100%;
  max-width: 700px;
  border-collapse: collapse;
}
.gap-table th {
  text-align: left;
  font-size: 13px;
  color: var(--text-dim);
  padding: 6px 12px;
  border-bottom: 1px solid #333;
}
.gap-table td {
  padding: 8px 12px;
  font-size: 14px;
  border-bottom: 1px solid #1a1a1a;
}
.gap-table .plus {
  color: var(--green);
  font-weight: 700;
  font-size: 16px;
}
.gap-table tr { opacity: 0; }

/* ===== SLIDE 7: SUMMARY / TIMELINE ===== */
#slide8 {
  background: radial-gradient(ellipse at center, #1a1a2e 0%, #0a0a0a 70%);
}
.timeline {
  display: flex;
  align-items: center;
  gap: 0;
  margin-bottom: 48px;
  position: relative;
}
.timeline-node {
  display: flex;
  flex-direction: column;
  align-items: center;
  opacity: 0;
  z-index: 2;
}
.timeline-node .year {
  font-size: 18px;
  color: var(--text-dim);
  margin-bottom: 8px;
}
.timeline-node .circle {
  width: 80px; height: 80px;
  border-radius: 50%;
  display: flex; flex-direction: column;
  align-items: center; justify-content: center;
  font-size: 24px; font-weight: 700;
  border: 3px solid;
}
.timeline-node .rank {
  font-size: 14px;
  color: var(--text-dim);
  margin-top: 8px;
}
.timeline-node:nth-child(1) .circle { border-color: var(--red); color: var(--red); }
.timeline-node:nth-child(3) .circle { border-color: var(--yellow); color: var(--yellow); }
.timeline-node:nth-child(5) .circle { border-color: var(--green); color: var(--green); }

.timeline-line {
  width: 120px;
  height: 3px;
  background: #333;
  position: relative;
  overflow: hidden;
  z-index: 1;
}
.timeline-line .fill {
  height: 100%;
  width: 0%;
  background: var(--accent);
  transition: width 0.8s ease;
}

.key-message {
  font-size: 36px;
  font-weight: 700;
  text-align: center;
  opacity: 0;
}
.key-message span { color: var(--accent); }
.closing-sub {
  font-size: 18px;
  color: var(--text-dim);
  margin-top: 12px;
  opacity: 0;
  text-align: center;
}

/* ===== KPI CATEGORY HEADER SLIDE ===== */
.kpi-cat-header {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 16px;
}
.kpi-cat-name {
  font-size: 52px;
  font-weight: 700;
  opacity: 0;
}
.kpi-cat-pts {
  font-size: 24px;
  color: var(--text-dim);
  opacity: 0;
}
.kpi-cat-list {
  list-style: none;
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  margin-top: 16px;
}
.kpi-cat-list li {
  background: var(--bg-card);
  border: 1px solid #333;
  border-radius: 8px;
  padding: 10px 20px;
  font-size: 15px;
  opacity: 0;
}

/* ===== KPI DATA SLIDE ===== */
.kpi-data-slide {
  width: 100%;
  max-width: 1100px;
  display: flex;
  flex-direction: column;
  gap: 20px;
  align-items: stretch;
}
/* Top bar: category badge + title + lead */
.kpi-top-bar {
  display: flex;
  align-items: center;
  gap: 16px;
  opacity: 0;
}
.kpi-cat-badge {
  font-size: 11px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 1.5px;
  padding: 4px 12px;
  border-radius: 4px;
  white-space: nowrap;
}
.kpi-title {
  font-size: 28px;
  font-weight: 700;
  flex: 1;
}
.kpi-lead {
  font-size: 13px;
  color: var(--text-dim);
  white-space: nowrap;
}
/* Two-column body */
.kpi-body {
  display: flex;
  gap: 24px;
}
.kpi-left {
  flex: 3;
  display: flex;
  flex-direction: column;
  gap: 16px;
  opacity: 0;
}
.kpi-right {
  flex: 2;
  display: flex;
  flex-direction: column;
  gap: 16px;
  opacity: 0;
}
/* SVG chart container */
.kpi-chart-card {
  background: var(--bg-card);
  border: 1px solid #333;
  border-radius: 12px;
  padding: 16px;
}
.kpi-chart-card svg {
  width: 100%;
  height: auto;
}
.kpi-desc {
  font-size: 14px;
  color: #bbb;
  line-height: 1.5;
}
.kpi-desc strong { color: #fff; }
/* Score display */
.kpi-score-display {
  background: var(--bg-card);
  border: 1px solid #333;
  border-radius: 12px;
  padding: 20px;
  text-align: center;
  opacity: 0;
}
.kpi-score-big {
  font-size: 48px;
  font-weight: 700;
}
.kpi-score-max {
  font-size: 20px;
  color: var(--text-dim);
}
.kpi-score-label {
  font-size: 13px;
  color: var(--text-dim);
  margin-top: 4px;
}
/* Rolling percentage badges */
.kpi-pct-row {
  display: flex;
  gap: 12px;
  justify-content: center;
  margin-top: 8px;
}
.kpi-pct-badge {
  background: rgba(255,255,255,0.08);
  border-radius: 8px;
  padding: 6px 14px;
  text-align: center;
  font-size: 13px;
}
.kpi-pct-badge .val {
  font-size: 20px;
  font-weight: 700;
  display: block;
}
/* Scoring criteria table */
.kpi-scoring-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 12px;
}
.kpi-scoring-table th {
  text-align: left;
  color: var(--text-dim);
  padding: 4px 8px;
  border-bottom: 1px solid #333;
  font-weight: 600;
}
.kpi-scoring-table td {
  padding: 4px 8px;
  border-bottom: 1px solid #1a1a1a;
}
.kpi-scoring-table tr.active-range {
  background: rgba(26,115,232,0.15);
  border-radius: 4px;
}
.kpi-scoring-table .pts-col {
  text-align: right;
  font-weight: 700;
  color: var(--accent);
}

/* ===== KPI LEARNING SLIDE ===== */
.kpi-learning-slide {
  width: 100%;
  max-width: 1000px;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 28px;
}
.kpi-learn-top {
  display: flex;
  align-items: center;
  gap: 16px;
  opacity: 0;
}
/* Score circles for learning slide */
.kpi-circle {
  width: 140px;
  height: 140px;
  border-radius: 50%;
  border: 6px solid var(--bg-bar);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  opacity: 0;
}
.kpi-circle .num {
  font-size: 36px;
  font-weight: 700;
}
.kpi-circle .lbl {
  font-size: 12px;
  color: var(--text-dim);
}
.kpi-circle.prev { border-color: var(--text-dim); }
.kpi-circle.next { border-color: var(--green); }
.kpi-learn-arrow {
  font-size: 36px;
  color: var(--accent);
  opacity: 0;
}
/* Two-card layout */
.kpi-cards {
  display: flex;
  gap: 24px;
  width: 100%;
}
.kpi-card {
  flex: 1;
  background: var(--bg-card);
  border: 1px solid #333;
  border-radius: 12px;
  padding: 20px 24px;
  opacity: 0;
}
.kpi-card h4 {
  font-size: 15px;
  font-weight: 700;
  margin-bottom: 12px;
  display: flex;
  align-items: center;
  gap: 8px;
}
.kpi-card.learning h4 { color: var(--yellow); }
.kpi-card.plan h4 { color: var(--green); }
.kpi-card ul {
  list-style: none;
  padding: 0;
}
.kpi-card li {
  font-size: 14px;
  color: #ccc;
  line-height: 1.6;
  padding-left: 16px;
  position: relative;
  margin-bottom: 6px;
}
.kpi-card li::before {
  content: '•';
  position: absolute;
  left: 0;
  color: var(--text-dim);
}

/* ===== RESPONSIVE (smaller screens) ===== */
@media (max-width: 1024px) {
  .slide { padding: 30px 30px; }
  #slide1 h1 { font-size: 42px; }
  .bar-label { width: 140px; min-width: 140px; font-size: 12px; }
  .fw-row-arrow { width: 30px; font-size: 16px; }
  .fw-header-row .fw-col-arrow { width: 30px; }
  .gauge-section { flex-direction: column; gap: 20px; }
}
</style>
</head>
<body>

<!-- ========== SLIDE 1: TITLE ========== -->
<div class="slide active" id="slide1">
  <!-- CSS-only three stripes (Adidas-inspired) -->
  <div class="three-stripes" id="stripes">
    <div class="stripe"></div>
    <div class="stripe"></div>
    <div class="stripe"></div>
  </div>
  <h1 id="title-text">SPIKE <span>Performance Journey</span></h1>
  <div class="subtitle" id="subtitle-text">
    Thong Thai &nbsp;|&nbsp; 2024 <span class="year-arrow">→</span> 2026
  </div>
</div>

<!-- ========== SLIDE 2: 2024 SCORECARD ========== -->
<div class="slide" id="slide2">
  <div class="slide-header">
    <h2 id="s2-title">2024 Full Year</h2>
    <div>
      <span class="score-badge" id="s2-score">52.5</span>
      <span class="rank-badge" id="s2-rank">Rank #12</span>
    </div>
  </div>
  <div class="bar-chart" id="chart2024">
    <!-- Bars injected by JS -->
  </div>
</div>

<!-- ========== SLIDE 3: 2025 SCORECARD ========== -->
<div class="slide" id="slide3">
  <div class="slide-header">
    <h2 id="s3-title">2025 Full Year</h2>
    <div>
      <span class="score-badge" id="s3-score">60.1</span>
      <span class="rank-badge" id="s3-rank">Rank #7</span>
      <span class="rank-change" id="s3-change">&#9650; 5 places</span>
    </div>
  </div>
  <div class="bar-chart" id="chart2025">
    <!-- Bars injected by JS -->
  </div>
  <div class="callouts" id="callouts3">
    <!-- Callout badges injected by JS -->
  </div>
</div>

<!-- ========== SLIDE 4: WEIGHT OVERVIEW ========== -->
<div class="slide" id="slide4">
  <div class="slide-header">
    <h2 id="s4-title">2026 Framework — What Changed?</h2>
  </div>
  <div class="weight-chart" id="weight-chart">
    <!-- Weight rows injected by JS -->
  </div>
  <div class="weight-note" id="weight-note">
    Total remains <strong>100 points</strong> — weights shifted toward Competency
  </div>
</div>

<!-- ========== SLIDE 5: 2026 FRAMEWORK CHANGES ========== -->
<div class="slide" id="slide5">
  <div class="slide-header">
    <h2 id="s5-title">What Changed in the 2026 Framework?</h2>
  </div>
  <!-- Column headers -->
  <div class="fw-header-row">
    <h3 class="fw-col-title" id="fw-title-left">2025</h3>
    <div class="fw-col-arrow"></div>
    <h3 class="fw-col-title" id="fw-title-right">2026</h3>
  </div>
  <!-- Paired rows injected by JS -->
  <div class="fw-rows" id="fw-rows"></div>
  <div class="structure-badges" id="struct-badges">
    <div class="struct-badge struct-foundation">Foundation — 70 pts</div>
    <div class="struct-badge struct-value">Value — 30 pts</div>
  </div>
  <div class="fw-note" id="fw-note">
    Total still <strong>100 pts</strong> — 8 KPIs across Foundation (70) + Value (30)
  </div>
</div>

<!-- ========== SLIDE 5: JANUARY 2026 ========== -->
<div class="slide" id="slide6">
  <div class="slide-header">
    <h2 id="s6-title">January 2026</h2>
    <div>
      <span class="score-badge" id="s6-score">34.9</span>
      <span class="rank-badge" id="s6-rank">Rank #16</span>
    </div>
  </div>
  <div class="bar-chart" id="chart2026">
    <!-- Bars injected by JS -->
  </div>
</div>

<!-- ========== SLIDE 6: ROAD TO #1 ========== -->
<div class="slide" id="slide7">
  <div class="slide-header">
    <h2 id="s7-title">End of Year Target</h2>
  </div>
  <div class="gauge-section">
    <div class="score-circle current" id="s7-current">
      <div class="number">34.9</div>
      <div class="label-text">January</div>
    </div>
    <div class="score-arrow" id="s7-arrow">→</div>
    <div class="score-circle target" id="s7-target">
      <div class="number">62.2</div>
      <div class="label-text">Target</div>
    </div>
    <div class="gap-info" id="s7-gap">
      <div class="points">+27.3</div>
      <div class="label-text">points needed</div>
    </div>
  </div>
  <div class="rank-goal" id="s7-rankgoal">
    <div class="rank-circle rank-from">#16</div>
    <span style="font-size:28px;color:var(--accent)">→</span>
    <div class="rank-circle rank-to">#7</div>
  </div>
  <table class="gap-table" id="gap-table">
    <thead>
      <tr style="opacity:1">
        <th>Category</th>
        <th>Current</th>
        <th>Target</th>
        <th>Gap</th>
      </tr>
    </thead>
    <tbody>
      <!-- Rows injected by JS -->
    </tbody>
  </table>
</div>

<!-- ========== SLIDE 7: SUMMARY ========== -->
<div class="slide" id="slide8">
  <div class="timeline" id="timeline">
    <div class="timeline-node">
      <div class="year">2024</div>
      <div class="circle">52.5</div>
      <div class="rank">#12</div>
    </div>
    <div class="timeline-line"><div class="fill" id="tl-fill1"></div></div>
    <div class="timeline-node">
      <div class="year">2025</div>
      <div class="circle">60.1</div>
      <div class="rank">#7</div>
    </div>
    <div class="timeline-line"><div class="fill" id="tl-fill2"></div></div>
    <div class="timeline-node">
      <div class="year">2026 Target</div>
      <div class="circle">62.2</div>
      <div class="rank">#7</div>
    </div>
  </div>
  <div class="key-message" id="key-msg">From <span>#12</span> to targeting <span>#7</span></div>
  <div class="closing-sub" id="closing-sub">+9.7 points over 3 years of continuous improvement</div>
</div>

<!-- ========== SLIDE COUNTER ========== -->
<div id="slide-counter">1 / 8</div>
<div id="nav-hint">Click or press → to advance &nbsp;|&nbsp; ← to go back</div>

<!-- ========== JAVASCRIPT ========== -->
<script>
// =============================================
// DATA
// =============================================

// 2024 scores: [category name, max points, actual score, group category]
const data2024 = [
  ['Availability',       10, 0,  'Agile'],
  ['Responsiveness',     15, 5,  null],
  ['FOB',                10, 6,  'Competitive'],
  ['ME',                 10, 7,  null],
  ['Digital',            10, 6,  null],
  ['Social Compliance',  10, 9,  'ESG'],
  ['Environmental',       5, 4,  null],
  ['Traceability',        5, 3,  null],
  ['Quality',            15, 5,  'Quality'],
  ['Product & Dev Comp', 10, 8,  'Competency'],
];

// 2025 scores: [category name, max points, actual score, change vs 2024, group category]
const data2025 = [
  ['Availability',       10,  4,  +4, 'Agile — 25%'],
  ['Responsiveness',     15,  9,  +4, null],
  ['FOB',                10,  5,  -1, 'Competitive — 25%'],
  ['ME',                 15, 12,  +5, null],
  ['Social Compliance',  10,  9,   0, 'ESG — 20%'],
  ['Environmental',       5,  4,   0, null],
  ['Traceability',        5,  5,  +2, null],
  ['Quality',            15,  3,  -2, 'Quality — 15%'],
  ['Product & Dev Comp', 15,  9,  +1, 'Competency — 15%'],
];

// 2026 January: [category name, max points, target, january score, note or null, group category]
// Using the 8 official KPIs from the 2026 framework
const data2026 = [
  ['Availability',                  10, 10,    10,    null,            'Agile — 20%'],
  ['Responsiveness',                10,  9,     9,    null,            null],
  ['FOB / Landed Cost Achievement', 15,  0,     0,    'Target TBD',   'Competitive — 15%'],
  ['Social Compliance',             10,  8.5,   0,    'Audited Q4',   'ESG — 20%'],
  ['Sourcing Sustainability',       10,  7.2,   5.85, null,            null],
  ['Quality',                       15,  8.5,   0,    'Not yet scored','Quality — 15%'],
  ['Product & Dev Competency',      20, 13,    10,    null,            'Competency — 30%'],
  ['Engineering Solutions',         10,  6,     0,    'Not yet scored', null],
];

// Gap analysis rows for slide 6: [category, current, target, gap]
const gapData = [
  ['Social Compliance',        0,     8.5,  +8.5],
  ['Quality',                  0,     8.5,  +8.5],
  ['Engineering Solutions',    0,     6,    +6.0],
  ['Product & Dev Competency', 10,   13,    +3.0],
  ['Sourcing Sustainability',  5.85,  7.2,  +1.35],
];

// Slide 4 data: category weight changes (2025 → 2026)
// [category name, 2025 weight %, 2026 weight %, CSS color class]
const weightData = [
  { name: 'Agile',       from: 25, to: 20, barCls: 'weight-bar-agile',       labelCls: 'fw-cat-agile' },
  { name: 'Competitive', from: 25, to: 15, barCls: 'weight-bar-competitive', labelCls: 'fw-cat-competitive' },
  { name: 'ESG',         from: 20, to: 20, barCls: 'weight-bar-esg',         labelCls: 'fw-cat-esg' },
  { name: 'Quality',     from: 15, to: 15, barCls: 'weight-bar-quality',     labelCls: 'fw-cat-quality' },
  { name: 'Competency',  from: 15, to: 30, barCls: 'weight-bar-competency',  labelCls: 'fw-cat-competency' },
];

// Category header data: [name, color, total points, sub-KPI names]
const categoryHeaders = [
  { name: 'Agile',      color: '#4fc3f7', pts: 20, badge: 'fw-cat-agile',
    kpis: ['MDP (7 pts)', 'SDP (3 pts)', 'Responsiveness (5 pts)', 'EFD (5 pts)'] },
  { name: 'ESG',        color: '#81c784', pts: 20, badge: 'fw-cat-esg',
    kpis: ['Social Compliance (10 pts)', 'Environmental (7 pts)', 'Product Traceability (3 pts)'] },
  { name: 'Quality',    color: '#ce93d8', pts: 15, badge: 'fw-cat-quality',
    kpis: ['Q-KPI (15 pts)'] },
  { name: 'Competency', color: '#ffb74d', pts: 30, badge: 'fw-cat-competency',
    kpis: ['Product & Dev Competency (20 pts)', 'Engineering Solutions (10 pts)'] },
];

// All KPI detail data — each object drives one data slide (and optionally one learning slide)
const kpiData = [
  // ===== AGILE =====
  {
    id: 'mdp',                                           // unique slug for slide IDs
    name: 'MDP — Material Delivery Performance',         // full display name
    category: 'Agile',                                   // parent category
    catColor: '#4fc3f7',                                 // category accent color
    lead: 'Apisak',                                      // lead person
    maxPts: 7,                                           // maximum points possible
    currentScore: 7,                                     // January 2026 score
    rollingPct: 97.8,                                    // rolling year-to-date %
    janPct: 98.6,                                        // January %
    targetPct: '91% (APP/FTW) / 94% (A&G)',             // target threshold description
    description: 'PODD (FGR) on-time delivery vs Customer Request Date. Measures how reliably materials arrive by the date the customer originally requested.',
    // Scoring criteria: [range label, points awarded]
    scoring: [
      ['< 70%', 0], ['70–79%', 1], ['80–84%', 2], ['85–87%', 3],
      ['88–90%', 4], ['91–93%', 5], ['94–96%', 6], ['≥ 97%', 7],
    ],
    currentRange: '≥ 97%',                               // which scoring range we're in
    hasLearning: true,                                   // show a learning slide?
    endYear2025: 4,                                      // end-of-year 2025 score
    maxPts2025: 10,                                      // 2025 scale max
    target2026: 7,                                       // 2026 target score
    keyLearning: [                                       // bullet points for learning card
      'Backlog from 2024 caused delays in early months',
      'Insufficient material management and planning',
      'Reactive approach to PO tracking',
    ],
    improvementPlan: [                                   // bullet points for plan card
      'Actively track PO status in real-time',
      'Weekly material reviews 3 buckets ahead',
      'Set up early-warning alerts for at-risk POs',
    ],
  },
  {
    id: 'sdp',
    name: 'SDP — Shipping Delivery Performance',
    category: 'Agile',
    catColor: '#4fc3f7',
    lead: 'Apisak',
    maxPts: 3,
    currentScore: 3,
    rollingPct: 99.6,
    janPct: 99.0,
    targetPct: '97%',
    description: 'Shipped on-time vs Confirmed Ship Date. Measures how reliably finished goods ship by the confirmed date.',
    scoring: [
      ['< 90%', 0], ['90–94%', 1], ['95–96%', 2], ['≥ 97%', 3],
    ],
    currentRange: '≥ 97%',
    hasLearning: true,
    endYear2025: 0,
    maxPts2025: 3,
    target2026: 3,
    keyLearning: [
      'Too focused on MDP, neglected SDP monitoring',
      'Orders confirmed with less than 21 days lead time',
      'Lack of daily shipping schedule follow-up',
    ],
    improvementPlan: [
      'Refocus team attention on SDP alongside MDP',
      'Ensure minimum 21-day production lead time',
      'Daily shipping status reviews in morning meetings',
    ],
  },
  {
    id: 'responsiveness',
    name: 'Responsiveness',
    category: 'Agile',
    catColor: '#4fc3f7',
    lead: 'Apisak',
    maxPts: 5,
    currentScore: 4,
    rollingPct: 27.2,
    janPct: 27.2,
    targetPct: '≥ 30%',
    description: 'Percentage of shipped volume from Responsiveness Programs: Rapid Creation, In Season, Planned Responsiveness, NOS/SLT, Customization, CHASE & Components.',
    scoring: [
      ['< 5%', 0], ['5–10%', 1], ['10–15%', 2], ['15–20%', 3], ['20–30%', 4], ['≥ 30%', 5],
    ],
    currentRange: '20–30%',
    hasLearning: false,                                  // no learning slide for responsiveness
  },
  {
    id: 'efd',
    name: 'EFD — Elevated Focus Delivery',
    category: 'Agile',
    catColor: '#4fc3f7',
    lead: 'Atipat / Kanyakorn',
    maxPts: 5,
    currentScore: 5,
    rollingPct: 99.3,
    janPct: 99.3,
    targetPct: '95% (MDP) / 99% (Samples)',
    description: 'On-time delivery for Priority Products (MDP EFD) and sample submissions (Sample MDP). Ensures elevated focus items get top priority.',
    scoring: [
      ['< 85%', 0], ['85–90%', 1], ['90–92%', 2], ['93–94%', 3], ['95–97%', 4], ['≥ 98%', 5],
    ],
    currentRange: '≥ 98%',
    hasLearning: true,
    endYear2025: 3,
    maxPts2025: 5,
    target2026: 5,
    keyLearning: [
      'Lack of proper follow-up on elevated focus items',
      'Insufficient Priority Product awareness across teams',
      'Late identification of at-risk priority shipments',
    ],
    improvementPlan: [
      'Clearly identify Priority Products in all reports',
      'Enforce no-delay policy for SPOMA priority items',
      'Weekly priority product status review with all teams',
    ],
  },
  // ===== ESG =====
  {
    id: 'social-compliance',
    name: 'Social Compliance (SI-KPI)',
    category: 'ESG',
    catColor: '#81c784',
    lead: 'Natchamai',
    maxPts: 10,
    currentScore: 0,
    rollingPct: null,                                    // no rolling % — audited Q4 only
    janPct: null,
    targetPct: '≥ 95% (Best in Class)',
    description: 'Social & Labor KPI score based on annual audit. Covers health & safety, worker rights, working hours, and management systems. Audited in Q4.',
    scoring: [
      ['< 30% (High Risk)', 0], ['30–60% (Low Perf)', 0], ['60–80% (Basic)', '1–5'],
      ['80–95% (High Perf)', '6–9'], ['≥ 95% (Best in Class)', 10],
    ],
    currentRange: 'Audited Q4',
    hasLearning: true,
    endYear2025: 9.25,
    maxPts2025: 10,
    target2026: 8.5,
    keyLearning: [
      'Zero Lost Time Injury maintained throughout 2025',
      'Strong safety compliance programs in place',
      'TTT achieved 5S certificate (all other factories 4S)',
    ],
    improvementPlan: [
      'Maintain zero injuries track record',
      'Strengthen worker participation via Welfare Committee',
      'Prepare early for Q4 audit with mock assessments',
    ],
  },
  {
    id: 'environmental',
    name: 'Environmental',
    category: 'ESG',
    catColor: '#81c784',
    lead: 'Anuchit',
    maxPts: 7,
    currentScore: 3.85,
    rollingPct: null,
    janPct: null,
    targetPct: '4.2 / 7 pts',
    description: 'Covers 3 topics: Decarbonization (3 pts), Nature (3 pts), Environmental Assessment (1 pt). Scored as average across 4 factories: TTT, VAS, Titan, TM2.',
    scoring: [
      ['TTT', 5.1], ['VAS', 3.3], ['Titan', 5.2], ['TM2', 1.8],
    ],
    currentRange: 'Avg = 3.85',
    scoringIsFactories: true,                            // flag: scoring table shows factories, not ranges
    hasLearning: true,
    endYear2025: 4,
    maxPts2025: 5,
    target2026: 4.2,
    keyLearning: [
      'SBTi: Successfully reduced Scope 1, 2, 3 emissions',
      'TM2 scores lowest at 1.8 — needs focused improvement',
      'Nature pillar requires better waste segregation data',
    ],
    improvementPlan: [
      'Solar rooftop expansion and I-REC procurement',
      'Waste segregation improvements across all factories',
      'RO reject water reuse project implementation',
      'Focus on TM2 to bring score up to group average',
    ],
  },
  {
    id: 'traceability',
    name: 'Product Traceability',
    category: 'ESG',
    catColor: '#81c784',
    lead: 'Pradthana',
    maxPts: 3,
    currentScore: 2,
    rollingPct: null,
    janPct: null,
    targetPct: '3 / 3 pts',
    description: 'Measures supply chain data: Completeness (SMTT PO Mapping), Timeliness (data submission), and Accuracy (audit results). Current: Completeness=1, Timeliness=1, Accuracy=N/A.',
    scoring: [
      ['Completeness', 1], ['Timeliness', 1], ['Accuracy', 'N/A'],
    ],
    currentRange: '2 / 3',
    scoringIsComponents: true,                           // flag: scoring table shows components, not ranges
    hasLearning: true,
    endYear2025: 5,
    maxPts2025: 5,
    target2026: 3,
    keyLearning: [
      'Data completeness achieved 100% through consistent SMTT PO mapping',
      'Timeliness maintained at 100% submission rate',
      'Accuracy score pending — audit not yet conducted',
    ],
    improvementPlan: [
      'Weekly SMTT monitoring to maintain data quality',
      'Prepare for accuracy audit in advance',
      'Cross-train team on traceability requirements',
    ],
  },
  // ===== QUALITY =====
  {
    id: 'quality',
    name: 'Quality (Q-KPI)',
    category: 'Quality',
    catColor: '#ce93d8',
    lead: 'Rapeepat',
    maxPts: 15,
    currentScore: 0,
    rollingPct: null,
    janPct: null,
    targetPct: '8.5 / 15 pts (4Q = 80%)',
    description: 'Quality Key Performance Index. Scored by quartile: <60% = 0 pts, ≥80% = 8 pts, ≥92% = 15 pts. 2025 actual: TTT=59(2Q), VAS=59(2Q), TITAN=59(2Q), TTM=76(3Q). AD4 SPIKE = 3.0.',
    scoring: [
      ['< 60% (1Q)', 0], ['60–79% (2Q)', '0–4'], ['80–91% (3Q)', '5–8'],
      ['80–91% (4Q)', '8–14'], ['≥ 92% (4Q+)', 15],
    ],
    currentRange: 'Not yet scored',
    hasLearning: true,
    endYear2025: 3.0,
    maxPts2025: 15,
    target2026: 8.5,
    keyLearning: [
      'TTM improved significantly from 40 to 76 (3Q level)',
      'Testing component achieved maximum score of 10',
      'WHC score decreased 16 points due to VAS CMA failures in Q1-Q2',
      'WH Claim reduced: 65,650 pcs → 18,798 pcs (-71%)',
    ],
    improvementPlan: [
      'Target all factories at 4Q level (≥ 80%)',
      'QMS: CTQ/OCPT integration, ISO 9001:2015 alignment',
      'People: Digital AI quality upskilling program',
      'Process: Lab testing capacity expansion',
      'Compliance: RQC reinforcement across all COOs',
    ],
  },
  // ===== COMPETENCY =====
  {
    id: 'product-dev',
    name: 'Product & Dev Competency',
    category: 'Competency',
    catColor: '#ffb74d',
    lead: 'Kanyakorn',
    maxPts: 20,
    currentScore: 10,
    rollingPct: null,
    janPct: null,
    targetPct: '13 / 20 pts',
    description: '7 sub-KPIs: Category Knowledge, Product Expertise, Dev Sample Performance, Buy Ready Excellence, Adaptability, Adherence to Policy, Product Mix. All at "Meet expectation" level in January.',
    scoring: [
      ['Below expectation', '0–6'], ['Meet expectation', '7–13'],
      ['Exceed expectation', '14–17'], ['Outstanding', '18–20'],
    ],
    currentRange: 'Meet expectation',
    hasLearning: true,
    endYear2025: 9,
    maxPts2025: 15,
    target2026: 13,
    keyLearning: [
      'Cross-category alignment improved team collaboration',
      'Football License readiness achieved (Base 26-28)',
      'Complex bonding capabilities developed (Stella, FB GK)',
      '99% Buy Ready on-time, 98% Proto / 99% Commercial on-time',
    ],
    improvementPlan: [
      'Strategic capacity planning for seasonal peaks',
      'Expand to Outdoor and Kids Bra categories (FB LIC Base29)',
      'Digital enablement: automation of sample tracking',
      'CTQ / Fit4Purpose implementation across all categories',
    ],
  },
  {
    id: 'engineering',
    name: 'Engineering Solutions',
    category: 'Competency',
    catColor: '#ffb74d',
    lead: 'Araya',
    maxPts: 10,
    currentScore: null,                                  // not yet scored
    rollingPct: null,
    janPct: null,
    targetPct: '6 / 10 pts',
    description: 'NEW KPI in 2026 (replaces ME from Competitive). 4 areas: Fundamentals (4 pts — Lean, Automation, Digital, Commitment), Concepts (6 pts — HPC Delivery, Ingredients, Commitment).',
    scoring: [
      ['Fundamentals', 4], ['Concepts', 6],
    ],
    currentRange: 'Not yet scored',
    scoringIsComponents: true,
    hasLearning: false,                                  // new KPI, no 2025 comparison
  },
];

// Slide 5 data: grouped by category so left and right rows always align
const fwGroups = [
  {
    catLeft: 'Agile — 25%', catRight: 'Agile — 20% (was 25%)', catCls: 'fw-cat-agile',
    left: [
      { name: 'Availability',   pts: 10, cls: '',                desc: 'MDP (7) + SDP (3)' },
      { name: 'Responsiveness', pts: 15, cls: 'highlight-changed', desc: 'Resp (5) + Origin Opt (5) + EFD (5)' },
    ],
    right: [
      { name: 'Availability',   pts: 10, cls: '',                desc: 'Same — MDP (7) + SDP (3)' },
      { name: 'Responsiveness', pts: 10, cls: 'highlight-changed', desc: '15→10; Origin Opt moved to Cost; now Resp(5)+EFD(5)' },
    ]
  },
  {
    catLeft: 'Competitive — 25%', catRight: 'Competitive — 15% (was 25%)', catCls: 'fw-cat-competitive',
    left: [
      { name: 'FOB', pts: 10, cls: 'highlight-changed', desc: 'Actual vs Target FOB variance (0-10 scale)' },
      { name: 'ME',  pts: 15, cls: 'highlight-removed',  desc: 'Efficiency roadmap (5) + Enablers projects (10)' },
    ],
    right: [
      { name: 'FOB / Landed Cost Achievement', pts: 15, cls: 'highlight-changed', desc: '10→15; FOB Target(5) + Holistic Cost(5) + Duty Benefit(5)' },
      null,  // empty — ME moved to Competency
    ]
  },
  {
    catLeft: 'ESG — 20%', catRight: 'ESG — 20% (unchanged)', catCls: 'fw-cat-esg',
    left: [
      { name: 'Social Compliance',  pts: 10, cls: '', desc: 'S-KPI or Compliance Scorecard' },
      { name: 'Env + Traceability', pts: 10, cls: 'highlight-changed', desc: 'Environmental (5) + Traceability (5)' },
    ],
    right: [
      { name: 'Social Compliance',      pts: 10, cls: '', desc: 'Same — S-KPI or Compliance Scorecard' },
      { name: 'Sourcing Sustainability', pts: 10, cls: 'highlight-changed', desc: 'Was Env(5)+Trace(5) → now Env(7)+Trace(3)' },
    ]
  },
  {
    catLeft: 'Quality — 15%', catRight: 'Quality — 15% (unchanged)', catCls: 'fw-cat-quality',
    left: [
      { name: 'Quality', pts: 15, cls: '', desc: 'Q-KPI Full or Q-KPI Light program' },
    ],
    right: [
      { name: 'Quality', pts: 15, cls: '', desc: 'Same — Q-KPI Full or Light program' },
    ]
  },
  {
    catLeft: 'Competency — 15%', catRight: 'Competency — 30% (was 15%)', catCls: 'fw-cat-competency',
    left: [
      { name: 'Product & Dev Comp', pts: 15, cls: 'highlight-changed', desc: 'Competency (6) + Discipline (2) + Enablement (2) + NPS (5)' },
      null,  // empty — no equivalent for Engineering Solutions in 2025
    ],
    right: [
      { name: 'Product & Dev Competency', pts: 20, cls: 'highlight-changed', desc: '15→20; +5 pts from new POPS NPS score' },
      { name: 'Engineering Solutions',    pts: 10, cls: 'highlight-new',     desc: 'NEW — replaces ME (moved from Competitive)' },
    ]
  },
];

// Key callouts for slide 3
const callouts = [
  { label: 'Availability',  val: '0 → 4',   cls: 'up' },
  { label: 'ME',             val: '7 → 12',  cls: 'up' },
  { label: 'Responsiveness', val: '5 → 9',   cls: 'up' },
  { label: 'Traceability',   val: '3 → 5',   cls: 'up' },
  { label: 'Quality',        val: '5 → 3',   cls: 'down' },
  { label: 'FOB',            val: '6 → 5',   cls: 'down' },
];

// =============================================
// HELPERS
// =============================================

// Return a color class based on how much of the max was scored
function barColor(score, max) {
  const pct = score / max;
  if (pct <= 0)   return 'bar-red';
  if (pct < 0.4)  return 'bar-red';
  if (pct < 0.65) return 'bar-yellow';
  return 'bar-green';
}

// Build a bar row HTML string
function buildBarRow(label, max, score, extraClass) {
  const pct = (score / max) * 100;         // percentage width for the bar
  const color = barColor(score, max);       // pick red/yellow/green
  return `
    <div class="bar-row ${extraClass || ''}">
      <div class="bar-label">${label}</div>
      <div class="bar-track">
        <div class="bar-fill ${color}" data-width="${pct}">
          <span class="bar-value">${score} / ${max}</span>
        </div>
      </div>
    </div>`;
}

// Build a bar row for 2026 (with target dashed line and progress %)
function buildBarRow2026(label, max, target, jan, note) {
  const janPct = (jan / max) * 100;         // bar width based on January score
  const targetPct = (target / max) * 100;   // dashed target line position
  const progressPct = target > 0 ? Math.round((jan / target) * 100) : 100;
  const color = barColor(jan, max);
  const noteHtml = note ? `<span class="note-badge">${note}</span>` : '';
  return `
    <div class="bar-row">
      <div class="bar-label">${label}${noteHtml}</div>
      <div class="bar-track">
        <div class="bar-fill ${color}" data-width="${janPct}">
          <span class="bar-value">${jan} / ${max}</span>
        </div>
        <div class="bar-target-line" style="left:${targetPct}%">
          <span class="bar-target-label">target ${target}</span>
        </div>
        <span class="bar-pct" style="right:-85px">${progressPct}% of target</span>
      </div>
    </div>`;
}

// =============================================
// KPI SLIDE BUILDERS
// =============================================

// Build an SVG mini line chart showing monthly data with a target line
// data = array of monthly values (Jan=index 0), targetVal = dashed target line, color = line color
function buildSvgChart(data, targetVal, maxY, color) {
  const months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
  const w = 500;                            // SVG viewBox width
  const h = 180;                            // SVG viewBox height
  const pad = 40;                           // padding for axes
  const chartW = w - pad * 2;               // usable chart width
  const chartH = h - pad * 2;               // usable chart height

  // Scale a value (0–maxY) to a Y pixel coordinate (top = high values)
  function yPos(val) { return pad + chartH - (val / maxY) * chartH; }
  // Scale a month index (0–11) to an X pixel coordinate
  function xPos(i) { return pad + (i / 11) * chartW; }

  let svg = `<svg viewBox="0 0 ${w} ${h}" xmlns="http://www.w3.org/2000/svg">`;

  // Background grid lines (horizontal at 25%, 50%, 75%, 100%)
  for (let p = 0; p <= 100; p += 25) {
    const y = yPos(maxY * p / 100);
    svg += `<line x1="${pad}" y1="${y}" x2="${w - pad}" y2="${y}" stroke="#333" stroke-width="0.5"/>`;
    svg += `<text x="${pad - 6}" y="${y + 4}" fill="#666" font-size="9" text-anchor="end">${Math.round(maxY * p / 100)}%</text>`;
  }

  // Month labels along bottom
  months.forEach((m, i) => {
    svg += `<text x="${xPos(i)}" y="${h - 8}" fill="#666" font-size="8" text-anchor="middle">${m}</text>`;
  });

  // Target dashed line
  if (targetVal != null) {
    const ty = yPos(targetVal);
    svg += `<line x1="${pad}" y1="${ty}" x2="${w - pad}" y2="${ty}" stroke="${color}" stroke-width="1" stroke-dasharray="6,4" opacity="0.5"/>`;
    svg += `<text x="${w - pad + 4}" y="${ty + 3}" fill="${color}" font-size="9" opacity="0.7">Target</text>`;
  }

  // Data line and dots
  if (data.length > 0) {
    // Draw connecting line if multiple points
    if (data.length > 1) {
      const points = data.map((val, i) => `${xPos(i)},${yPos(val)}`).join(' ');
      svg += `<polyline points="${points}" fill="none" stroke="${color}" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>`;
    }
    // Draw dots and value labels for each data point
    data.forEach((val, i) => {
      const cx = xPos(i);
      const cy = yPos(val);
      svg += `<circle cx="${cx}" cy="${cy}" r="5" fill="${color}" stroke="#1a1a1a" stroke-width="2"/>`;
      svg += `<text x="${cx}" y="${cy - 10}" fill="#fff" font-size="10" font-weight="bold" text-anchor="middle">${val}%</text>`;
    });
  }

  // "No data yet" placeholders for empty months
  for (let i = data.length; i < 12; i++) {
    svg += `<circle cx="${xPos(i)}" cy="${yPos(0)}" r="3" fill="#333" opacity="0.3"/>`;
  }

  svg += '</svg>';
  return svg;
}

// Build HTML for a KPI category header slide
function buildCategoryHeaderSlide(cat) {
  const kpiList = cat.kpis.map(k => `<li>${k}</li>`).join('');
  return `
    <div class="slide" data-animate="kpi-category">
      <div class="kpi-cat-header">
        <div class="kpi-cat-name" style="color:${cat.color}">${cat.name}</div>
        <div class="kpi-cat-pts">${cat.pts} points · ${cat.kpis.length} KPI${cat.kpis.length > 1 ? 's' : ''}</div>
        <ul class="kpi-cat-list">${kpiList}</ul>
      </div>
    </div>`;
}

// Build HTML for a KPI data slide (chart + scoring table + score display)
function buildKpiDataSlide(kpi) {
  // Category badge with colored background
  const badge = `<span class="kpi-cat-badge" style="background:${kpi.catColor}22;color:${kpi.catColor};border:1px solid ${kpi.catColor}44">${kpi.category}</span>`;

  // Score display — show current score or "X" if not yet scored
  const scoreText = kpi.currentScore != null ? kpi.currentScore : 'X';
  const scoreColor = kpi.currentScore != null ? kpi.catColor : 'var(--text-dim)';

  // Rolling percentage badges (only for KPIs that have percentage data)
  let pctBadges = '';
  if (kpi.rollingPct != null || kpi.janPct != null) {
    pctBadges = '<div class="kpi-pct-row">';
    if (kpi.rollingPct != null) {
      pctBadges += `<div class="kpi-pct-badge"><span class="val" style="color:${kpi.catColor}">${kpi.rollingPct}%</span>Rolling</div>`;
    }
    if (kpi.janPct != null) {
      pctBadges += `<div class="kpi-pct-badge"><span class="val" style="color:${kpi.catColor}">${kpi.janPct}%</span>January</div>`;
    }
    pctBadges += '</div>';
  }

  // SVG chart (only for KPIs with percentage-based rolling data)
  let chartHtml = '';
  if (kpi.rollingPct != null) {
    const chartData = [kpi.janPct || kpi.rollingPct];  // at minimum, January value
    const targetNum = parseFloat(kpi.targetPct) || 90;  // extract numeric target for the line
    chartHtml = `<div class="kpi-chart-card">${buildSvgChart(chartData, targetNum, 100, kpi.catColor)}</div>`;
  }

  // Scoring criteria table
  let tableHtml = '<table class="kpi-scoring-table"><thead><tr>';
  // Choose column headers based on data type
  if (kpi.scoringIsFactories) {
    tableHtml += '<th>Factory</th><th class="pts-col">Score</th>';
  } else if (kpi.scoringIsComponents) {
    tableHtml += '<th>Component</th><th class="pts-col">Score</th>';
  } else {
    tableHtml += '<th>Range</th><th class="pts-col">Points</th>';
  }
  tableHtml += '</tr></thead><tbody>';
  kpi.scoring.forEach(([range, pts]) => {
    const isActive = (range === kpi.currentRange);
    tableHtml += `<tr${isActive ? ' class="active-range"' : ''}><td>${range}</td><td class="pts-col">${pts}</td></tr>`;
  });
  tableHtml += '</tbody></table>';

  return `
    <div class="slide" id="kpi-${kpi.id}-data" data-animate="kpi-data">
      <div class="kpi-data-slide">
        <div class="kpi-top-bar">
          ${badge}
          <span class="kpi-title">${kpi.name}</span>
          <span class="kpi-lead">Lead: ${kpi.lead}</span>
        </div>
        <div class="kpi-body">
          <div class="kpi-left">
            ${chartHtml}
            <div class="kpi-desc">
              <strong>What it measures:</strong> ${kpi.description}<br>
              <strong>Target:</strong> ${kpi.targetPct}
            </div>
          </div>
          <div class="kpi-right">
            <div class="kpi-score-display">
              <div class="kpi-score-big" style="color:${scoreColor}">${scoreText}<span class="kpi-score-max"> / ${kpi.maxPts}</span></div>
              <div class="kpi-score-label">January 2026 Score</div>
              ${pctBadges}
            </div>
            ${tableHtml}
          </div>
        </div>
      </div>
    </div>`;
}

// Build HTML for a KPI learning/plan slide (score circles + two cards)
function buildKpiLearningSlide(kpi) {
  if (!kpi.hasLearning) return '';     // skip if no learning data

  const badge = `<span class="kpi-cat-badge" style="background:${kpi.catColor}22;color:${kpi.catColor};border:1px solid ${kpi.catColor}44">${kpi.category}</span>`;

  // Scale label: show old scale if different from new (e.g., "9 / 15" vs "13 / 20")
  const prevLabel = kpi.maxPts2025 !== kpi.maxPts ? `${kpi.endYear2025} / ${kpi.maxPts2025}` : `${kpi.endYear2025}`;
  const nextLabel = `${kpi.target2026} / ${kpi.maxPts}`;

  // Bullet list for key learnings
  const learningItems = kpi.keyLearning.map(item => `<li>${item}</li>`).join('');

  // Bullet list for improvement plan
  const planItems = kpi.improvementPlan.map(item => `<li>${item}</li>`).join('');

  return `
    <div class="slide" id="kpi-${kpi.id}-learning" data-animate="kpi-learning">
      <div class="kpi-learning-slide">
        <div class="kpi-learn-top">
          ${badge}
          <span class="kpi-title">${kpi.name}</span>
        </div>
        <div style="display:flex;align-items:center;gap:32px;">
          <div class="kpi-circle prev">
            <div class="num">${kpi.endYear2025}</div>
            <div class="lbl">End 2025</div>
            <div class="lbl" style="font-size:10px;color:#666">(of ${kpi.maxPts2025} pts)</div>
          </div>
          <div class="kpi-learn-arrow">→</div>
          <div class="kpi-circle next">
            <div class="num">${kpi.target2026}</div>
            <div class="lbl">Target 2026</div>
            <div class="lbl" style="font-size:10px;color:#666">(of ${kpi.maxPts} pts)</div>
          </div>
        </div>
        <div class="kpi-cards">
          <div class="kpi-card learning">
            <h4>📋 Key Learning 2025</h4>
            <ul>${learningItems}</ul>
          </div>
          <div class="kpi-card plan">
            <h4>🎯 Improvement Plan 2026</h4>
            <ul>${planItems}</ul>
          </div>
        </div>
      </div>
    </div>`;
}

// =============================================
// INJECT CHARTS INTO THE DOM
// =============================================

// Map category names to color classes (matches by the first word)
const catColorMap = {
  'Agile':       'fw-cat-agile',
  'Competitive': 'fw-cat-competitive',
  'ESG':         'fw-cat-esg',
  'Quality':     'fw-cat-quality',
  'Competency':  'fw-cat-competency',
};

// Helper: build a category label row for bar charts
function buildCatLabel(catName) {
  // Find matching color by checking if the label starts with a known category name
  const key = Object.keys(catColorMap).find(k => catName.startsWith(k)) || '';
  const cls = key ? catColorMap[key] : '';
  return `<div class="bar-cat-label ${cls}">${catName}</div>`;
}

// Slide 2: 2024 chart
const chart2024El = document.getElementById('chart2024');
data2024.forEach(([label, max, score, cat]) => {
  if (cat) chart2024El.innerHTML += buildCatLabel(cat);   // insert category header
  chart2024El.innerHTML += buildBarRow(label, max, score);
});

// Slide 3: 2025 chart
const chart2025El = document.getElementById('chart2025');
data2025.forEach(([label, max, score, change, cat]) => {
  if (cat) chart2025El.innerHTML += buildCatLabel(cat);   // insert category header
  let extra = '';
  if (change > 0) extra = 'bar-improved';
  else if (change < 0) extra = 'bar-declined';
  chart2025El.innerHTML += buildBarRow(label, max, score, extra);
});

// Slide 3: callouts
const callouts3El = document.getElementById('callouts3');
callouts.forEach(c => {
  callouts3El.innerHTML += `
    <div class="callout">
      <div class="label">${c.label}</div>
      <div class="change ${c.cls}">${c.val}</div>
    </div>`;
});

// Slide 4: weight overview chart
const weightChartEl = document.getElementById('weight-chart');
weightData.forEach(w => {
  // Calculate bar width as percentage (30% = full width)
  const fromPct = (w.from / 30) * 100;       // 2025 bar width
  const toPct = (w.to / 30) * 100;           // 2026 bar width (used later in animation)
  const diff = w.to - w.from;                // change amount
  // Determine badge text and color class
  let badgeText, badgeCls;
  if (diff > 0)      { badgeText = '+' + diff + '%'; badgeCls = 'up'; }
  else if (diff < 0) { badgeText = diff + '%';       badgeCls = 'down'; }
  else               { badgeText = 'No change';      badgeCls = 'same'; }
  weightChartEl.innerHTML += `
    <div class="weight-row">
      <div class="weight-label ${w.labelCls}">${w.name}</div>
      <div class="weight-track">
        <div class="weight-bar ${w.barCls}" data-from="${fromPct}" data-to="${toPct}" style="width:0%">
          <span class="weight-pct">${w.from}%</span>
        </div>
      </div>
      <div class="weight-change-badge ${badgeCls}" data-text="${badgeText}">${badgeText}</div>
    </div>`;
});

// Slide 5: render paired framework rows
// Helper: build HTML for one item card, or an empty placeholder
function fwItemHtml(item) {
  if (!item) return '<div class="fw-empty"></div>';
  const descHtml = item.desc ? `<div class="fw-desc">${item.desc}</div>` : '';
  return `
    <div class="fw-item ${item.cls}">
      <div class="fw-item-left">
        <span>${item.name}</span>
        ${descHtml}
      </div>
      <span class="pts">${item.pts} pts</span>
    </div>`;
}

const fwRowsEl = document.getElementById('fw-rows');
fwGroups.forEach(group => {
  // 1) Category header row — left label | empty | right label
  fwRowsEl.innerHTML += `
    <div class="fw-row cat-row">
      <div class="fw-row-left"><div class="fw-cat-label ${group.catCls}">${group.catLeft}</div></div>
      <div class="fw-row-arrow"></div>
      <div class="fw-row-right"><div class="fw-cat-label ${group.catCls}">${group.catRight}</div></div>
    </div>`;

  // 2) Item rows — pair left[i] with right[i], use arrow between them
  const maxRows = Math.max(group.left.length, group.right.length);
  for (let i = 0; i < maxRows; i++) {
    const leftItem  = i < group.left.length  ? group.left[i]  : null;
    const rightItem = i < group.right.length ? group.right[i] : null;
    fwRowsEl.innerHTML += `
      <div class="fw-row">
        <div class="fw-row-left">${fwItemHtml(leftItem)}</div>
        <div class="fw-row-arrow">→</div>
        <div class="fw-row-right">${fwItemHtml(rightItem)}</div>
      </div>`;
  }
});

// Slide 5: 2026 January chart
const chart2026El = document.getElementById('chart2026');
data2026.forEach(([label, max, target, jan, note, cat]) => {
  if (cat) chart2026El.innerHTML += buildCatLabel(cat);   // insert category header
  chart2026El.innerHTML += buildBarRow2026(label, max, target, jan, note);
});

// Slide 6: gap table
const gapTableBody = document.querySelector('#gap-table tbody');
gapData.forEach(([cat, cur, tgt, gap]) => {
  gapTableBody.innerHTML += `
    <tr>
      <td>${cat}</td>
      <td>${cur}</td>
      <td>${tgt}</td>
      <td class="plus">+${gap}</td>
    </tr>`;
});

// =============================================
// INJECT KPI DETAIL SLIDES INTO THE DOM
// =============================================

// We insert KPI slides after slide5 (framework detail) and before slide6 (January 2026).
// Each category gets: 1 header slide, then data + learning slides for each KPI.
const slide5El = document.getElementById('slide5');   // the framework detail slide
let insertAfter = slide5El;                           // tracks where to insert next

// Helper: insert a slide HTML string after a given element
function insertSlideAfter(refEl, html) {
  refEl.insertAdjacentHTML('afterend', html);         // add HTML right after the reference element
  return refEl.nextElementSibling;                    // return the newly created element
}

// Loop through each category and its KPIs
categoryHeaders.forEach(cat => {
  // 1) Insert category header slide
  insertAfter = insertSlideAfter(insertAfter, buildCategoryHeaderSlide(cat));

  // 2) Insert data + learning slides for each KPI in this category
  const catKpis = kpiData.filter(k => k.category === cat.name);
  catKpis.forEach(kpi => {
    // Data slide (always)
    insertAfter = insertSlideAfter(insertAfter, buildKpiDataSlide(kpi));
    // Learning slide (only if this KPI has learning data)
    if (kpi.hasLearning) {
      insertAfter = insertSlideAfter(insertAfter, buildKpiLearningSlide(kpi));
    }
  });
});

// =============================================
// SLIDE NAVIGATION
// =============================================

let currentSlide = 1;       // start on slide 1

// Collect ALL slides in DOM order (existing + newly injected KPI slides)
const slides = Array.from(document.querySelectorAll('.slide'));
const totalSlides = slides.length;

const counterEl = document.getElementById('slide-counter');

// Go to a specific slide number (1-based)
function goToSlide(n) {
  if (n < 1 || n > totalSlides) return;   // don't go out of bounds
  // Hide all slides
  slides.forEach(s => s.classList.remove('active'));
  // Show target slide
  slides[n - 1].classList.add('active');
  currentSlide = n;
  counterEl.textContent = n + ' / ' + totalSlides;
  // Run entry animations for this slide
  animateSlide(n);
}

// Advance to next slide
function nextSlide() { goToSlide(currentSlide + 1); }

// Go back one slide
function prevSlide() { goToSlide(currentSlide - 1); }

// Listen for clicks (anywhere) to advance
document.addEventListener('click', (e) => {
  // Ignore if clicking on the nav hint area (bottom strip)
  if (e.clientY > window.innerHeight - 60 && e.clientX > window.innerWidth - 300) return;
  nextSlide();
});

// Listen for keyboard: → / Space = next, ← = previous
document.addEventListener('keydown', (e) => {
  if (e.key === 'ArrowRight' || e.key === ' ') {
    e.preventDefault();
    nextSlide();
  } else if (e.key === 'ArrowLeft') {
    e.preventDefault();
    prevSlide();
  }
});

// =============================================
// ANIMATIONS FOR EACH SLIDE
// =============================================

// Track which slides have already been animated so we don't repeat
const animated = {};

function animateSlide(n) {
  if (animated[n]) return;     // only animate once
  animated[n] = true;

  // Get the actual slide element for this position
  const slideEl = slides[n - 1];
  const slideId = slideEl.id;

  // Dispatch animation based on slide ID or data-animate attribute
  // Original hardcoded slides use their fixed IDs
  if (slideId === 'slide1') animateSlide1();
  else if (slideId === 'slide2') animateSlide2();
  else if (slideId === 'slide3') animateSlide3();
  else if (slideId === 'slide4') animateSlide4();
  else if (slideId === 'slide5') animateSlide5();
  else if (slideId === 'slide6') animateSlide6();
  else if (slideId === 'slide7') animateSlide7();
  else if (slideId === 'slide8') animateSlide8();
  // Dynamically generated KPI slides use data-animate attribute
  else if (slideEl.dataset.animate === 'kpi-data') animateKpiDataSlide(slideEl);
  else if (slideEl.dataset.animate === 'kpi-learning') animateKpiLearningSlide(slideEl);
  else if (slideEl.dataset.animate === 'kpi-category') animateKpiCategorySlide(slideEl);
}

// ----- SLIDE 1: Title -----
function animateSlide1() {
  const stripes = document.getElementById('stripes');
  const title   = document.getElementById('title-text');
  const sub     = document.getElementById('subtitle-text');

  // Animate stripes first
  setTimeout(() => {
    stripes.style.opacity = '1';
    stripes.style.animation = 'fadeInUp 0.6s ease forwards';
  }, 200);

  // Then title
  setTimeout(() => {
    title.style.animation = 'fadeInUp 0.8s ease forwards';
  }, 600);

  // Then subtitle
  setTimeout(() => {
    sub.style.animation = 'fadeIn 0.8s ease forwards';
  }, 1200);
}

// ----- SLIDE 2: 2024 chart -----
function animateSlide2() {
  const title = document.getElementById('s2-title');
  const score = document.getElementById('s2-score');
  const rank  = document.getElementById('s2-rank');

  setTimeout(() => { title.style.animation = 'fadeInUp 0.5s ease forwards'; }, 100);
  setTimeout(() => { score.style.animation = 'countUp 0.5s ease forwards'; }, 400);
  setTimeout(() => { rank.style.animation  = 'fadeIn 0.4s ease forwards'; }, 600);

  // Animate category labels and bar rows together
  const allItems = document.querySelectorAll('#chart2024 .bar-cat-label, #chart2024 .bar-row');
  allItems.forEach((el, i) => {
    setTimeout(() => {
      el.style.animation = 'fadeInUp 0.4s ease forwards';
      // Also grow the bar fill if this is a bar row
      const fill = el.querySelector('.bar-fill');
      if (fill) {
        fill.style.width = fill.dataset.width + '%';
      }
    }, 700 + i * 100);
  });
}

// ----- SLIDE 3: 2025 chart -----
function animateSlide3() {
  const title  = document.getElementById('s3-title');
  const score  = document.getElementById('s3-score');
  const rank   = document.getElementById('s3-rank');
  const change = document.getElementById('s3-change');

  setTimeout(() => { title.style.animation = 'fadeInUp 0.5s ease forwards'; }, 100);
  setTimeout(() => { score.style.animation = 'countUp 0.5s ease forwards'; }, 400);
  setTimeout(() => { rank.style.animation  = 'fadeIn 0.4s ease forwards'; }, 600);
  setTimeout(() => { change.style.animation = 'popIn 0.4s ease forwards'; }, 900);

  // Animate category labels and bars together
  const allItems = document.querySelectorAll('#chart2025 .bar-cat-label, #chart2025 .bar-row');
  allItems.forEach((el, i) => {
    setTimeout(() => {
      el.style.animation = 'fadeInUp 0.4s ease forwards';
      const fill = el.querySelector('.bar-fill');
      if (fill) fill.style.width = fill.dataset.width + '%';
    }, 1000 + i * 100);
  });

  // Animate callouts
  const couts = document.querySelectorAll('#callouts3 .callout');
  couts.forEach((c, i) => {
    setTimeout(() => {
      c.style.animation = 'popIn 0.3s ease forwards';
    }, 2200 + i * 150);
  });
}

// ----- SLIDE 4: Weight overview -----
function animateSlide4() {
  const title = document.getElementById('s4-title');
  setTimeout(() => { title.style.animation = 'fadeInUp 0.5s ease forwards'; }, 100);

  // Show each weight row one by one, with bars at 2025 width
  const rows = document.querySelectorAll('#weight-chart .weight-row');
  rows.forEach((row, i) => {
    setTimeout(() => {
      row.style.animation = 'fadeInUp 0.4s ease forwards';
      // Set bar to 2025 width
      const bar = row.querySelector('.weight-bar');
      if (bar) bar.style.width = bar.dataset.from + '%';
    }, 400 + i * 200);
  });

  // After all rows are visible, animate bars to 2026 widths
  const transitionDelay = 400 + rows.length * 200 + 800;
  setTimeout(() => {
    rows.forEach(row => {
      const bar = row.querySelector('.weight-bar');
      if (bar) {
        // Update the percentage text to show 2026 value
        const pctEl = bar.querySelector('.weight-pct');
        // Convert bar width back to actual percentage (30% scale)
        const toPercent = Math.round(parseFloat(bar.dataset.to) / 100 * 30);
        if (pctEl) pctEl.textContent = toPercent + '%';
        bar.style.width = bar.dataset.to + '%';
      }
    });
  }, transitionDelay);

  // Pop in the change badges after bars finish moving
  const badgeDelay = transitionDelay + 1400;
  rows.forEach((row, i) => {
    const badge = row.querySelector('.weight-change-badge');
    if (badge) {
      setTimeout(() => {
        badge.style.animation = 'popIn 0.3s ease forwards';
      }, badgeDelay + i * 150);
    }
  });

  // Show the bottom note
  const note = document.getElementById('weight-note');
  setTimeout(() => { note.style.animation = 'fadeIn 0.5s ease forwards'; }, badgeDelay + rows.length * 150 + 200);
}

// ----- SLIDE 5: Framework changes -----
function animateSlide5() {
  const title = document.getElementById('s5-title');
  setTimeout(() => { title.style.animation = 'fadeInUp 0.5s ease forwards'; }, 100);

  // Column headers
  const leftTitle = document.getElementById('fw-title-left');
  const rightTitle = document.getElementById('fw-title-right');
  setTimeout(() => { leftTitle.style.animation = 'slideInLeft 0.4s ease forwards'; }, 200);
  setTimeout(() => { rightTitle.style.animation = 'slideInRight 0.4s ease forwards'; }, 200);

  // Animate each paired row one by one
  const allRows = document.querySelectorAll('#fw-rows .fw-row');
  allRows.forEach((row, i) => {
    setTimeout(() => {
      row.style.animation = 'fadeInUp 0.35s ease forwards';
    }, 500 + i * 100);
  });

  // Structure badges
  const totalRows = allRows.length;
  const badgeDelay = 500 + totalRows * 100 + 200;
  const badges = document.querySelectorAll('#struct-badges .struct-badge');
  badges.forEach((b, i) => {
    setTimeout(() => { b.style.animation = 'popIn 0.4s ease forwards'; }, badgeDelay + i * 200);
  });

  // Note
  const note = document.getElementById('fw-note');
  setTimeout(() => { note.style.animation = 'fadeIn 0.5s ease forwards'; }, badgeDelay + 500);
}

// ----- SLIDE 6: January 2026 -----
function animateSlide6() {
  const title = document.getElementById('s6-title');
  const score = document.getElementById('s6-score');
  const rank  = document.getElementById('s6-rank');

  setTimeout(() => { title.style.animation = 'fadeInUp 0.5s ease forwards'; }, 100);
  setTimeout(() => { score.style.animation = 'countUp 0.5s ease forwards'; }, 400);
  setTimeout(() => { rank.style.animation  = 'fadeIn 0.4s ease forwards'; }, 600);

  const allItems = document.querySelectorAll('#chart2026 .bar-cat-label, #chart2026 .bar-row');
  allItems.forEach((el, i) => {
    setTimeout(() => {
      el.style.animation = 'fadeInUp 0.4s ease forwards';
      const fill = el.querySelector('.bar-fill');
      if (fill) fill.style.width = fill.dataset.width + '%';
    }, 700 + i * 100);
  });
}

// ----- SLIDE 7: Road to #1 -----
function animateSlide7() {
  const title = document.getElementById('s7-title');
  setTimeout(() => { title.style.animation = 'fadeInUp 0.5s ease forwards'; }, 100);

  setTimeout(() => {
    document.getElementById('s7-current').style.animation = 'countUp 0.6s ease forwards';
  }, 400);
  setTimeout(() => {
    document.getElementById('s7-arrow').style.animation = 'fadeIn 0.4s ease forwards';
  }, 800);
  setTimeout(() => {
    document.getElementById('s7-target').style.animation = 'countUp 0.6s ease forwards';
  }, 1000);
  setTimeout(() => {
    document.getElementById('s7-gap').style.animation = 'popIn 0.5s ease forwards';
  }, 1400);
  setTimeout(() => {
    document.getElementById('s7-rankgoal').style.animation = 'fadeInUp 0.5s ease forwards';
  }, 1800);

  // Table rows
  const trows = document.querySelectorAll('#gap-table tbody tr');
  trows.forEach((row, i) => {
    setTimeout(() => {
      row.style.animation = 'fadeInUp 0.3s ease forwards';
    }, 2200 + i * 150);
  });
}

// ----- SLIDE 8: Summary timeline -----
function animateSlide8() {
  const nodes = document.querySelectorAll('.timeline-node');
  const fill1 = document.getElementById('tl-fill1');
  const fill2 = document.getElementById('tl-fill2');
  const msg   = document.getElementById('key-msg');
  const sub   = document.getElementById('closing-sub');

  // First node (2024)
  setTimeout(() => { nodes[0].style.animation = 'countUp 0.5s ease forwards'; }, 300);
  // Line 1 fills
  setTimeout(() => { fill1.style.width = '100%'; }, 800);
  // Second node (2025)
  setTimeout(() => { nodes[1].style.animation = 'countUp 0.5s ease forwards'; }, 1400);
  // Line 2 fills
  setTimeout(() => { fill2.style.width = '100%'; }, 1900);
  // Third node (2026)
  setTimeout(() => { nodes[2].style.animation = 'countUp 0.5s ease forwards'; }, 2500);
  // Key message
  setTimeout(() => { msg.style.animation = 'fadeInUp 0.6s ease forwards'; }, 3200);
  // Closing subtitle
  setTimeout(() => { sub.style.animation = 'fadeIn 0.5s ease forwards'; }, 3800);
}

// ----- KPI CATEGORY HEADER SLIDE -----
function animateKpiCategorySlide(el) {
  // Animate the category name (large colored text)
  const name = el.querySelector('.kpi-cat-name');
  setTimeout(() => { name.style.animation = 'fadeInUp 0.6s ease forwards'; }, 200);

  // Animate the points subtitle
  const pts = el.querySelector('.kpi-cat-pts');
  setTimeout(() => { pts.style.animation = 'fadeIn 0.4s ease forwards'; }, 600);

  // Stagger-reveal each KPI list item
  const items = el.querySelectorAll('.kpi-cat-list li');
  items.forEach((item, i) => {
    setTimeout(() => { item.style.animation = 'popIn 0.3s ease forwards'; }, 800 + i * 150);
  });
}

// ----- KPI DATA SLIDE -----
function animateKpiDataSlide(el) {
  // 1) Fade in the top bar (category badge + title + lead)
  const topBar = el.querySelector('.kpi-top-bar');
  setTimeout(() => { topBar.style.animation = 'fadeInUp 0.5s ease forwards'; }, 100);

  // 2) Slide in the left column (chart + description)
  const left = el.querySelector('.kpi-left');
  setTimeout(() => { left.style.animation = 'slideInLeft 0.5s ease forwards'; }, 400);

  // 3) Slide in the right column (score + scoring table)
  const right = el.querySelector('.kpi-right');
  setTimeout(() => { right.style.animation = 'slideInRight 0.5s ease forwards'; }, 600);

  // 4) Pop in the score display
  const scoreDisplay = el.querySelector('.kpi-score-display');
  if (scoreDisplay) {
    setTimeout(() => { scoreDisplay.style.animation = 'popIn 0.4s ease forwards'; }, 900);
  }
}

// ----- KPI LEARNING / PLAN SLIDE -----
function animateKpiLearningSlide(el) {
  // 1) Fade in the top bar (badge + title)
  const topBar = el.querySelector('.kpi-learn-top');
  setTimeout(() => { topBar.style.animation = 'fadeInUp 0.5s ease forwards'; }, 100);

  // 2) Pop in the 2025 score circle
  const prevCircle = el.querySelector('.kpi-circle.prev');
  if (prevCircle) {
    setTimeout(() => { prevCircle.style.animation = 'countUp 0.5s ease forwards'; }, 400);
  }

  // 3) Fade in the arrow between circles
  const arrow = el.querySelector('.kpi-learn-arrow');
  if (arrow) {
    setTimeout(() => { arrow.style.animation = 'fadeIn 0.3s ease forwards'; }, 700);
  }

  // 4) Pop in the 2026 target circle
  const nextCircle = el.querySelector('.kpi-circle.next');
  if (nextCircle) {
    setTimeout(() => { nextCircle.style.animation = 'countUp 0.5s ease forwards'; }, 900);
  }

  // 5) Slide in the learning card from the left
  const learningCard = el.querySelector('.kpi-card.learning');
  if (learningCard) {
    setTimeout(() => { learningCard.style.animation = 'slideInLeft 0.5s ease forwards'; }, 1200);
  }

  // 6) Slide in the plan card from the right
  const planCard = el.querySelector('.kpi-card.plan');
  if (planCard) {
    setTimeout(() => { planCard.style.animation = 'slideInRight 0.5s ease forwards'; }, 1400);
  }
}

// =============================================
// INITIAL SETUP
// =============================================

// Update the slide counter to show actual total
counterEl.textContent = '1 / ' + totalSlides;

// Animate slide 1 on page load
animateSlide(1);

</script>
</body>
</html>
